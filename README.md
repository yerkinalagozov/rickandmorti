# Rick & Morty Fullstack — Explorer

Полноценное full‑stack приложение для поиска и просмотра персонажей вселенной «Рик и Морти». Состоит из современного фронтенда (React + Vite) и легковесного бэкенд‑прокси на Go. Готово к локальному запуску и деплою (Netlify для фронтенда и любой хостинг контейнеров для бэкенда).

## Содержание
- Краткое описание
- Архитектура и структура проекта
- Установка и запуск
  - Локальный запуск (Frontend)
  - Локальный запуск (Backend)
  - Запуск в Docker (Backend)
  - Переменные окружения
- Проектирование и процесс разработки
- Уникальные подходы и методологии
- Компромиссы и принятые решения
- Известные ограничения и проблемы
- Почему выбран этот технический стек
- Дальнейшие планы

---

## Краткое описание
Приложение показывает список персонажей и их детали из публичного Rick and Morty API. Фронтенд обращается к нашему Go‑бэкенду, который выступает в роли прокси/адаптера: валидирует запросы, добавляет базовые заголовки, агрегирует и маппит параметры.

Цели:
- Быстрое и удобное SPA с современным DX (Vite, TypeScript, React Query, Tailwind).
- Тонкий бэкенд, который можно расширять до более строгой Clean Architecture/DDD (заложены основы: роутер, хелс‑чеки, Docker, Makefile).

## Архитектура и структура проекта
Корень проекта содержит две части:

- rick-morty-frontend — Vite + React 18 + TypeScript, Tailwind CSS, React Router, React Query, Zustand, Netlify конфигурация.
- rick-morty-backend — Go (gorilla/mux) минимальный HTTP‑сервер с health‑эндпойнтом, прокси для /api/v1/characters, Dockerfile, Makefile.

Ключевые файлы (фрагменты):
- Frontend:
  - src/services/api/client.ts — Axios‑клиент с перехватчиками, базовой обработкой ошибок.
  - src/services/cache/queryClient.ts — конфигурация React Query.
  - src/store/useThemeStore.ts — хранение темы (light/dark) через Zustand.
  - public/_redirects и netlify.toml — конфигурация для Netlify.
- Backend:
  - cmd/api/main.go — запуск сервера и обработчик /api/v1/characters (прокси к rickandmortyapi.com).
  - deployments/docker/Dockerfile — двухстейджовый образ.
  - Makefile — сборка/запуск/контейнер.

## Установка и запуск

### Требования
- Node.js 18+
- npm или pnpm/yarn (в README примеры с npm)
- Go 1.22+
- (опционально) Docker

### 1) Frontend (локально)
```bash
cd rick-morty-frontend
cp .env.example .env   # при необходимости укажите VITE_API_BASE_URL
npm ci
npm run dev
```
По умолчанию фронтенд ожидает бэкенд на http://localhost:8080/api/v1.

Сборка продакшен‑бандла:
```bash
npm run build
npm run preview
```

### 2) Backend (локально)
```bash
cd rick-morty-backend
cp .env.example .env   # при необходимости измените ADDR
make run               # или go run ./cmd/api/main.go
```
Сервер поднимется на :8080. Проверьте health:
```
curl http://localhost:8080/api/v1/health
```
Список персонажей (прокси):
```
curl 'http://localhost:8080/api/v1/characters?page=1'
```

### 3) Backend в Docker
```bash
cd rick-morty-backend
make docker-build
make docker-run   # прокинет порт 8080
```

### 4) Docker Compose (Frontend + Backend)
В корне проекта доступен docker-compose.yml для одновременного запуска фронтенда и бэкенда:
```bash
# из корня репозитория
docker compose up --build
# Откройте http://localhost:7878 — фронт, API доступен на http://localhost:8080
```
По умолчанию фронтенд внутри контейнера получает VITE_API_BASE_URL=http://localhost:8080/api/v1, что корректно работает из браузера.

### Переменные окружения
- Frontend: VITE_API_BASE_URL (пример в rick-morty-frontend/.env.example)
- Backend: ADDR (пример в rick-morty-backend/.env.example). По умолчанию :8080.

### Деплой (кратко)
- Frontend (Netlify): netlify.toml уже настроен. Достаточно указать VITE_API_BASE_URL и задать директорию билда dist.
- Backend: использовать Docker‑образ из deployments/docker/Dockerfile и задеплоить в Render/Railway/Fly.io/другой хост.

## Проектирование и процесс разработки
- Сначала определена итоговая архитектура: SPA на фронте и простой прокси на Go как стартовая точка. Это позволяет быстро показать ценность продукта и при этом заложить базу для роста к Clean Architecture/DDD.
- Сконцентрировались на DX и скорости разработки UI:
  - Vite — мгновенная перезагрузка и быстрая сборка.
  - React Query — кэширование запросов и управление состоянием данных.
  - Zustand — минималистичный state management для UI‑состояний (например, тема).
  - Tailwind — быстрая стилизация, согласованная дизайн‑система через CSS‑переменные.
- На бэкенде — минимальный рабочий прокси с корректными заголовками, health‑эндпойнтом и Docker‑сборкой. Это упрощает дальнейшее расширение до полноценного слоя адаптеров/юзкейсов.

## Уникальные подходы и методологии
- Прокси‑бэкенд вместо прямого вызова внешнего API с фронта:
  - Возможность централизовать кеширование/валидацию/логирование/рейт‑лимитинг.
  - Готовность к расширению до полноценной Clean Architecture/DDD.
- Клиент API на фронте с перехватчиками ошибок и заделом на дедупликацию запросов.
- React Query конфиг со стабильными дефолтами (staleTime, retry, refetchOnWindowFocus=false).
- Netlify redirects (_redirects и netlify.toml) — удобный локальный/продакшен роутинг и проксирование /api/*.
- Темизация через CSS custom properties + Zustand переключатель (поддержка light/dark и кастомных эффектов: portal/glitch/neon‑button).

## Компромиссы и принятые решения
- Бэкенд упрощён до прокси (без БД, без полноценного Domain/Application слоёв) ради скорости запуска. Это осознанный trade‑off: быстрее Time‑to‑First‑Value, но меньше гибкости на старте.
- Обработка ошибок на фронте — user‑friendly тосты без детальной классификации; можно расширить централизованным error boundary/логированием.
- Отказались от SSR/SSG (Next.js) в пользу легковесного SPA, т.к. данные динамические, а SEO здесь не критичен.
- Нет сложного роутинга и кэш‑инвалидации — пока достаточно базовых сценариев.

## Известные ограничения и проблемы
- Бэкенд сейчас не кеширует ответы и не проводит полноценную валидацию/нормализацию данных. Это можно добавить на уровне middleware/слоя "адаптеров".
- Нет e2e/интеграционных тестов. В ближайших планах — добавить smoke‑тесты и контракты API.
- Ограниченный набор маршрутов: реализован список персонажей. Детализация/поиск/фильтрация могут быть расширены на бэкенде.
- CORS: для продакшена рекомендуется настроить строгие Origin‑политики и убрать "*".
- Упрощённая дедупликация запросов в axios пока не активна (заготовка под ключ запросов есть, но очередь не используется для отмены).

## Почему выбран этот технический стек
- React 18 + TypeScript — зрелая экосистема, высокая скорость разработки, строгая типизация для устойчивости к регрессиям.
- Vite — максимально быстрый dev‑сервер и сборка; простота интеграции с TS/Tailwind.
- React Query — стандарт де‑факто для работы с серверными данными в SPA: кэш, рефетч, статус загрузки.
- Zustand — лёгкий и предсказуемый state management без лишней церемонии.
- Tailwind CSS — быстрый и консистентный способ стилизации, легко поддерживать дизайн‑систему через переменные.
- Axios — гибкий HTTP‑клиент с перехватчиками и поддержкой отмены/таймаутов.
- Go (gorilla/mux) — простота, производительность и лёгкие контейнеры. Хорошо подходит для тонких прокси и последующего масштабирования до сервисов с чистой архитектурой.
- Docker/Makefile — воспроизводимость сборок и единообразные команды для CI/CD.

## Дальнейшие планы
- Расширить бэкенд: ввести слой доменных моделей/юзкейсов, кэш (Redis), рейт‑лимитинг, метрики, централизованный логгер.
- Добавить эндпойнты: детальная страница персонажа, эпизоды, локации, поиск/фильтры.
- Тестирование: unit/integration/e2e, GitHub Actions pipeline.
- Улучшить DX: генерация типов API, Storybook для UI‑компонентов, визуальные тесты.

---

### Быстрый старт
1) Back: `cd rick-morty-backend && make run`
2) Front: `cd rick-morty-frontend && cp .env.example .env && npm ci && npm run dev`
Откройте http://localhost:7878 — раздел Characters должен отображать список персонажей. Также доступна страница Search (/search) для поиска по персонажам, эпизодам и локациям.

